// Code generated by protoc-gen-liverpc v0.1, DO NOT EDIT.
// source: v1/AppIndex.proto

/*
Package v1 is a generated liverpc stub package.
This code was generated with go-common/app/tool/liverpc/protoc-gen-liverpc v0.1.

It is generated from these files:
	v1/AppIndex.proto
	v1/Area.proto
	v1/Room.proto
	v1/RoomEx.proto
	v1/RoomMng.proto
	v1/RoomPendant.proto
	v1/RoomRecommend.proto
	v1/Skin.proto
*/
package v1

import context "context"

import proto "github.com/golang/protobuf/proto"
import "go-common/library/net/rpc/liverpc"

var _ proto.Message // generate to suppress unused imports
// Imports only used by utility functions:

// ==================
// AppIndex Interface
// ==================

type AppIndexRPCClient interface {
	// * 根据moduleId查common房间列表
	//
	GetListByIds(ctx context.Context, req *AppIndexGetListByIdsReq, opts ...liverpc.CallOption) (resp *AppIndexGetListByIdsResp, err error)
}

// ========================
// AppIndex Live Rpc Client
// ========================

type appIndexRPCClient struct {
	client *liverpc.Client
}

// NewAppIndexRPCClient creates a client that implements the AppIndexRPCClient interface.
func NewAppIndexRPCClient(client *liverpc.Client) AppIndexRPCClient {
	return &appIndexRPCClient{
		client: client,
	}
}

func (c *appIndexRPCClient) GetListByIds(ctx context.Context, in *AppIndexGetListByIdsReq, opts ...liverpc.CallOption) (*AppIndexGetListByIdsResp, error) {
	out := new(AppIndexGetListByIdsResp)
	err := doRPCRequest(ctx, c.client, 1, "AppIndex.getListByIds", in, out, opts)
	if err != nil {
		return nil, err
	}
	return out, nil
}

// =====
// Utils
// =====

func doRPCRequest(ctx context.Context, client *liverpc.Client, version int, method string, in, out proto.Message, opts []liverpc.CallOption) (err error) {
	err = client.Call(ctx, version, method, in, out, opts...)
	return
}
