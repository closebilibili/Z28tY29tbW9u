// Code generated by protoc-gen-bm v0.1, DO NOT EDIT.
// source: room.proto

/*
Package v1 is a generated blademaster stub package.
This code was generated with go-common/app/tool/bmgen/protoc-gen-bm v0.1.

It is generated from these files:
	room.proto
*/
package v1

import (
	"context"

	bm "go-common/library/net/http/blademaster"
	"go-common/library/net/http/blademaster/binding"
)

// to suppressed 'imported but not used warning'
var _ *bm.Context
var _ context.Context
var _ binding.StructValidator

var PathRoomMngGetSecondVerifyListWithPics = "/live.liveadmin.v1.roomMng/getSecondVerifyListWithPics"

// =================
// RoomMng Interface
// =================

type RoomMngBMServer interface {
	// 获取带有图片地址的二次审核列表
	// `method:"GET" internal:"true" `
	GetSecondVerifyListWithPics(ctx context.Context, req *RoomMngGetSecondVerifyListReq) (resp *RoomMngGetSecondVerifyListResp, err error)
}

var v1RoomMngSvc RoomMngBMServer

func roomMngGetSecondVerifyListWithPics(c *bm.Context) {
	p := new(RoomMngGetSecondVerifyListReq)
	if err := c.BindWith(p, binding.Default(c.Request.Method, c.Request.Header.Get("Content-Type"))); err != nil {
		return
	}
	resp, err := v1RoomMngSvc.GetSecondVerifyListWithPics(c, p)
	c.JSON(resp, err)
}

// RegisterV1RoomMngService Register the blademaster route with middleware map
// midMap is the middleware map, the key is defined in proto
func RegisterV1RoomMngService(e *bm.Engine, svc RoomMngBMServer, midMap map[string]bm.HandlerFunc) {
	v1RoomMngSvc = svc
	e.GET("/xlive/internal/live-admin/v1/roomMng/getSecondVerifyListWithPics", roomMngGetSecondVerifyListWithPics)
}

// RegisterRoomMngBMServer Register the blademaster route
func RegisterRoomMngBMServer(e *bm.Engine, server RoomMngBMServer) {
	v1RoomMngSvc = server
	e.GET("/live.liveadmin.v1.roomMng/getSecondVerifyListWithPics", roomMngGetSecondVerifyListWithPics)
}
